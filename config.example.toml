# Memo 主配置文件示例
# 复制此文件到 ~/.memo/config.toml 并根据需要修改

# 数据库路径（可选，默认: ~/.memo/brain）
# brain_path = "/path/to/your/brain"

# ============================================
# 服务配置（引用 providers.toml）
# ============================================

# Embedding 服务
# 推荐：aliyun.embed（便宜、快速、中文效果好）
embedding = "aliyun.embed"

# Rerank 服务
# 推荐：aliyun.rerank（效果好，智谱 rerank 存在质量问题）
rerank = "aliyun.rerank"

# LLM 服务（用于多查询拆解和结果总结）
llm = "aliyun.llm"

# ============================================
# 搜索配置
# ============================================

# 返回结果数量上限（默认: 10）
search_limit = 10

# 第一层搜索阈值（0.0-1.0，默认: 0.35）
# 较低的阈值可以召回更多候选，后续层级会使用更高的自适应阈值
similarity_threshold = 0.35

# 重复检测相似度阈值（0.0-1.0，默认: 0.85）
duplicate_threshold = 0.85

# ============================================
# 多查询搜索 - 递归拆解配置（需要配置 llm）
# ============================================

# [decomposition]
# 最大递归深度（默认: 3）
# max_level = 3

# 最大叶子节点数，即最终子问题数量上限（默认: 12）
# max_total_leaves = 12

# 每次拆解最多生成的子节点数（默认: 4）
# max_children = 4

# ============================================
# 多查询搜索 - 搜索与合并配置
# ============================================

# [multi_query]
# 每个子问题最多召回的候选数量（默认: 50）
# candidates_per_query = 50

# 每个叶子节点重排后保留数量（默认: 5）
# top_n_per_leaf = 5

# 每个叶子节点在最终结果中至少保留的记忆数（默认: 3）
# min_per_leaf = 3

# 最终返回的总记忆数上限（默认: 20）
# max_total_results = 20

# 去重阈值，向量相似度超过此值视为重复（默认: 0.98）
# dedup_threshold = 0.98

# ============================================
# 提示词策略配置（可选，覆盖内置策略）
# ============================================
#
# 说明：这里只需提供"策略内容"（如何拆解问题或如何整合记忆），
#       不要包含问题本身或记忆内容（框架会自动放置），
#       也不要描述 XML 输出格式（系统固定控制，无法修改）。
#
# [prompts]
#
# 拆解策略（覆盖内置五维拆解策略）
#
# 示例（三维拆解）：
# decompose = """
# 请将问题从三个角度拆解为子问题：
# - 背景（what）：问题的背景和定义
# - 解决方案（how）：具体的解决方法
# - 注意事项（note）：使用时的限制和风险
# """
#
# 总结策略（覆盖内置总结策略）
#
# summarize = """
# 请综合多条记忆，给出简洁、结构化的回答，突出关键信息和实用建议。
# """

